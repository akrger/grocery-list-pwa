{% extends "base.html" %}
{% block content %}
<div class="mdc-snackbar mdc-snackbar"
     aria-live="assertive"
     aria-atomic="true"
     aria-hidden="true">
    <div class="mdc-snackbar__text"></div>
    <div class="mdc-snackbar__action-wrapper">
	<button type="button" class="mdc-button mdc-snackbar__action-button"></button>
	</div>
</div>

<script>
 if ('serviceWorker' in navigator) {
     navigator.serviceWorker.register('serviceworker.js').then(function(registration) {
	 // Registration was successful

	 var newWorker = registration.installing;

	 // statechange fires every time the ServiceWorker.state changes
	 newWorker.onstatechange = function() {
	     // show the message on activation
	     if (newWorker.state == 'activated' && !navigator.serviceWorker.controller) {
 		 const MDCSnackbar = mdc.snackbar.MDCSnackbar;
 		 const snackbar = new MDCSnackbar(document.querySelector('.mdc-snackbar'));
 		 const dataObj = {
 		     message: "The app now works offline",
 		     actionText: 'Dismiss',
 		     actionHandler: function () {
 			 console.log('my cool function');
 		     }
 		 };
 		 snackbar.show(dataObj); 
	     }
	 };
     }).catch(function(err) {
	 // registration failed :(
     });
 }
</script>
{% endblock %}
